<<<<<<< HEAD
function alerta(e){return toastr.options={closeButton:!0,debug:!1,newestOnTop:!1,progressBar:!0,positionClass:"toast-top-center",preventDuplicates:!1,onclick:null,showDuration:"2000",hideDuration:"2000",timeOut:"4000",extendedTimeOut:"1000",showEasing:"swing",hideEasing:"linear",showMethod:"fadeIn",hideMethod:"fadeOut"},senhaCerta?(toastr.info("Senha atual inválida !"),!1):document.modalTrocaSenha.senha1.value==document.modalTrocaSenha.senha2.value?(toastr.success("Senha Alterada com sucesso!"),!0):(toastr.error("Confirmação de senha incorreta !"),!1)}function verificaSenhaModal(e){$.get("/cliente/pegasenha?login="+e+"&senha="+$("#senhaAtual").val(),function(e){"TRUE"!=e&&(senhaCerta=!0),console.log(e)})}function desassociar(){alertify.confirm("","Deseja excluir o usuário?",function(){document.tlEditarUser.action="/usuario/desassociar/"+document.getElementById("idUsuarioTlEditar").value,document.tlEditarUser.submit(),$("#quandoClica").addClass("loader")},function(){}).set("labels",{ok:"Sim",cancel:"Não"})}function voltarSemAlterar(e){alertify.confirm("","Deseja voltar sem Salvar as alterações ?",function(){source.close(),$(location).attr("href","/principal"),$("#quandoClica").addClass("loader")},function(){}).set("labels",{ok:"Sim",cancel:"Não"})}function editarDados(e){var t=JSON.parse(e);document.getElementById("idUsuarioTlEditar").value=t._id,document.getElementById("editarDispositivoUser").value=t.dispositivo,"LIFELINK"!=document.getElementById("podeEditarDispositivo").value&&"ATHENE"!=document.getElementById("podeEditarDispositivo").value||(document.getElementById("editarDispositivoUser").disabled=!1),null!==document.getElementById("identificadorClienteEditar")&&(document.getElementById("identificadorClienteEditar").value=t.cliente,clienteParaCombo=t.cliente),document.getElementById("editarNomeUsuario").value=t.nome,document.getElementById("editarSobrenomeUsuario").value=t.sobrenome,document.getElementById("editarUsuarioResidencia").value=t.telefone,document.getElementById("editarUserCelular").value=t.celular,document.getElementById("editarCPF").value=t.cpf,document.getElementById("editardatanascimento").value=t.data_nascimento,document.getElementById("editarRua").value=t.Endereco.rua,document.getElementById("editarNumeroEndereco").value=t.Endereco.numero,document.getElementById("editarBairro").value=t.Endereco.bairro,document.getElementById("editarCidade").value=t.Endereco.cidade,document.getElementById("editarComplemento").value=t.Endereco.complemento,document.getElementById("editarCep").value=t.Endereco.cep,document.getElementById("editarUf").value=t.Endereco.uf,document.getElementById("editarPontodeReferencia").value=t.Endereco.ponto_referencia,document.getElementById("editarPeso").value=t.peso,document.getElementById("editarSexo").value=t.sexo,document.getElementById("editarAltura").value=t.altura,document.getElementById("editarTipoSanguineo").value=t.tipo_sanguineo,document.getElementById("editarMedico").value=t.Medico.nome_medico,document.getElementById("editartelconsultorio").value=t.Medico.tel_consultorio,document.getElementById("editarTelResidenciaMedico").value=t.Medico.tel_residencial,document.getElementById("editarMedicoCelular").value=t.Medico.celular_medico,document.getElementById("editartelefoneHospital").value=t.Medico.tel_hospital,document.getElementById("editarHospitalPreferencia").value=t.Medico.hospital_preferencia,document.getElementById("editarPlano").value=t.Medico.plano_saude,document.getElementById("editarIdentiPlano").value=t.Medico.plano_identi,document.getElementById("editartelefonePlano").value=t.Medico.plano_telefone,document.getElementById("editarContato1Nome1").value=t.Contato1.nome1,document.getElementById("editarChave1").checked=t.Contato1.chaves1,document.getElementById("editarRelacao1").value=t.Contato1.relacao1,document.getElementById("editartelResidencia1").value=t.Contato1.telefone1_residencial,document.getElementById("editartelComercial1").value=t.Contato1.telefone1_comercial,document.getElementById("editartelCelular1").value=t.Contato1.telefone1_celular,document.getElementById("editarNome2").value=t.Contato2.nome2,document.getElementById("editarChave2").checked=t.Contato2.chaves2,document.getElementById("editarRelacao2").value=t.Contato2.relacao2,document.getElementById("editartelResidencia2").value=t.Contato2.telefone2_residencial,document.getElementById("editartelComercial2").value=t.Contato2.telefone2_comercial,document.getElementById("editartelCelular2").value=t.Contato2.telefone2_celular,document.getElementById("editarNome3").value=t.Contato3.nome3,document.getElementById("editarChave3").checked=t.Contato3.chaves3,document.getElementById("editarRelacao3").value=t.Contato3.relacao3,document.getElementById("editartelResidencia3").value=t.Contato3.telefone3_residencial,document.getElementById("editartelComercial3").value=t.Contato3.telefone3_comercial,document.getElementById("editartelCelular3").value=t.Contato3.telefone3_celular,document.getElementById("editarNome4").value=t.Contato4.nome4,document.getElementById("editarChave4").checked=t.Contato4.chaves4,document.getElementById("editarRelacao4").value=t.Contato4.relacao4,document.getElementById("editartelResidencia4").value=t.Contato4.telefone4_residencial,document.getElementById("editartelComercial4").value=t.Contato4.telefone4_comercial,document.getElementById("editartelCelular4").value=t.Contato4.telefone4_celular,document.getElementById("editarNome5").value=t.Contato5.nome5,document.getElementById("editarChave5").checked=t.Contato5.chaves5,document.getElementById("editarRelacao5").value=t.Contato5.relacao5,document.getElementById("editartelResidencia5").value=t.Contato5.telefone5_residencial,document.getElementById("editartelComercial5").value=t.Contato5.telefone5_comercial,document.getElementById("editartelCelular5").value=t.Contato5.telefone5_celular,document.getElementById("editarAudicao").checked=t.HistoricoMedico.audicao,document.getElementById("editarVisao").checked=t.HistoricoMedico.visao,document.getElementById("editarFala").checked=t.HistoricoMedico.fala,document.getElementById("editarRespiracao").checked=t.HistoricoMedico.respiracao,document.getElementById("editarCoracao").checked=t.HistoricoMedico.coracao,document.getElementById("editarPressao").checked=t.HistoricoMedico.pressao,document.getElementById("editarDiabete").checked=t.HistoricoMedico.diabete,document.getElementById("editarArtrite").checked=t.HistoricoMedico.artrite,document.getElementById("editarDerrame").checked=t.HistoricoMedico.derrame,document.getElementById("editarRiscoQueda").checked=t.HistoricoMedico.riscoQueda,document.getElementById("editarInstrucoes").value=AdicionarQuebraDeLinha(t.instrucoes_especiais),document.getElementById("editarAlergias").value=AdicionarQuebraDeLinha(t.alergia),document.getElementById("editarmedicamentosUser").value=AdicionarQuebraDeLinha(t.medicamento_em_uso),document.getElementById("observacaoEdit").value=AdicionarQuebraDeLinha(t.observacao),document.getElementById("editarOutro").value=t.HistoricoMedico.outro,mascaraTelefone_DataList()}function preencherDataListEditar(e,t){var a=[];$.each(e,function(e,t){a[e]=document.createElement("option"),$(a[e]).attr({value:t.nome}),$("#dispositivosDataListEditar").append(a[e])})}function substitui(e,t){return"string"==typeof t?t.replace(/\s/gm,"₻"):t}function possuiDispositivo(e,t){"TRUE"==e?(alertify.alert("","Este dispositivo já possui um usuário"),dispositivoPossuiUsuario=!0):"FALSE"==e&&(dispositivoPossuiUsuario=!1)}function validarData(e){var t=[];t=e.value.split("/"),t[0]>31||t[0]<0?alertify.alert("","Data Invalida dia maior que 31 ou menor que 0."):(t[1]>12||t[1]<0)&&alertify.alert("","Data Invalida mês maior que 12 ou menor que 0.")}function validarCamposRelatorio(e){var t=0,a="";if(""==e.dispositivoRelatorio.value&&""==e.mensagemRelatorio.value&&""==e.dataRelatorio1.value&&""==e.dataRelatorio2.value?(t++,a+="Não é possível fazer uma busca vazia por favor informe ao menos um intervalo."):""!=e.dataRelatorio1.value&&""!=e.dataRelatorio2.value||(t++,a+="Por favor, informe o intevalo da busca."),t>0)return alertify.alert("Campos necessários",a),!1;e.submit()}function validarEditarCliente(e){var t=0,a="";if(""===e.nome.value&&(t++,a+="* O Nome está em branco. </br>"),""===e.login.value&&(t++,a+="* O login está em branco. </br>"),t>0)return alertify.alert("Campos Obrigatórios!",a),$("#quandoClica").remove(),!1;e.submit()}function validarResetSenha(e){var t=0,a="";if(""===e.senha.value&&(t++,a+="* Por favor informe a nova senha.</br>"),""===e.confirmSenha.value&&(t++,a+="* Por favor informe a confirmação da nova senha.</br>"),e.confirmSenha.value!=e.senha.value&&(t++,a+="* Senha e confimação de senha estão diferentes"),t>0)return alertify.alert("Campos Obrigatórios!",a),$("#quandoClica").remove(),!1;e.submit()}function validarCadastroCliente(e){var t=0,a="";if(""===e.cliente.value&&(t++,a+="* Por favor informe o cliente.</br>"),""===e.nome.value&&(t++,a+="* Por favor informe o nome do cliente.</br>"),""===e.login.value&&(t++,a+="* Por favor informe o Login.</br>"),""===e.senha.value&&(t++,a+="* Por favor informe a senha.</br>"),""===e.confirmSenha.value&&(t++,a+="* Por favor confirme a senha.</br>"),e.senha.value!=e.confirmSenha.value&&(t++,a+="* Senha e confimação de senha estão diferentes.</br>"),t>0)return alertify.alert("Campos Obrigatórios!",a),$("#quandoClica").remove(),!1;e.submit()}function validarCampos(e){var t=0,a="";if(dispositivoPossuiUsuario&&(t++,a+="* Informe um dispositivo válido.  </br>\n"),""===e.NomeUsuario.value&&(t++,a+="* Informe o nome.  </br>\n"),""===e.dispositivoUser.value&&(e.dispositivoUser.value="Sem Usuario"),""===e.SobrenomeUsuario.value&&(t++,a+="* Informe o sobrenome.  </br>\n"),""===e.usuarioResidencia.value&&""===e.usuarioceluar.value&&(t++,a+="* Informe algum telefone do usuário. </br>\n"),(""===e.tlCreateNome1.value||""===e.tlCreateNome2.value||""===e.tlCreateNome3.value||""===e.telResidencia1.value&&""===e.telComercial1.value&&""===e.telCelular1.value||""===e.telResidencia2.value&&""===e.telComercial2.value&&""===e.telCelular2.value||""===e.telResidencia3.value&&""===e.telComercial3.value&&""===e.telCelular3.value)&&(t++,a+="* Informe ao menos três contatos para o usuário.  \n"),t>0)return alertify.alert("Campos Obrigatórios!",a),$("#quandoClica").remove(),!1;e.submit()}function validarEditarCampos(e){var t=0,a="";if(dispositivoPossuiUsuario&&(t++,a+="* Informe um dispositivo válido.  </br>\n"),""===e.editarNomeUsuario.value&&(t++,a+="* Informe o nome.  </br>\n"),""===e.editarSobrenomeUsuario.value&&(t++,a+="* Informe o sobrenome.  </br>\n"),""===e.editarUsuarioResidencia.value&&""===e.editarUserCelular.value&&(t++,a+="*  Informe algum telefone do usuário.  </br>\n"),(""===e.editarContato1Nome1.value||""===e.editarNome2.value||""===e.editarNome3.value||""===e.editartelResidencia1.value&&""===e.editartelComercial1.value&&""===e.editartelCelular1.value||""===e.editartelResidencia2.value&&""===e.editartelComercial2.value&&""===e.editartelCelular2.value||""===e.editartelResidencia3.value&&""===e.editartelComercial3.value&&""===e.editartelCelular3.value)&&(t++,a+="* Informe ao menos três contatos do usuário.  </br>\n"),t>0)return alertify.alert("",a),$("#quandoClica").remove(),!1;e.submit()}function apaganotifi(){$("#mostrar_notificacao").hide()}function testeNotificacaoSOS(e){new Notification("Chegou um SOS!",{dir:"auto",icon:"images/SOS_B1.png",lang:"",vibrate:"[200, 100, 200]",body:"Olá, por favor entre em contato com o usuário do dispositivo "+e,tag:"tag"})}function testeNotificacaoAjuda(e){new Notification("Chegou um novo Alarme!",{dir:"auto",icon:"images/Alarme_B1.png",lang:"",vibrate:"[200, 100, 200]",body:"Olá, por favor entre em contato com o usuário do dispositivo "+e,tag:"tag"}).onclick=function(){}}function createRequest(){try{request=new XMLHttpRequest}catch(e){try{request=new ActiveXObject("Msxml2.XMLHTTP")}catch(e){try{request=new ActiveXObject("Microsoft.XMLHTTP")}catch(e){request=null}}}null===request&&alert("Error creating request object!")}function getInformacaoQualquer(e){createRequest();var t="/principal/viu?nome="+e+"&visto=true";request.open("POST",t,!0),request.onreadystatechange=atualizaPagina,request.send()}function atualizaPagina(){if(4==request.readyState){request.responseText}}function testeCarregando(){$("#quandoClica").addClass("loader")}function validarLoginModal(e){if(0==grecaptcha.getResponse().length)return $("#errorMensagem").show(),$("#errorMensagem").text("Captcha não marcado!"),!1;$.get("/cliente/temlogin?login="+e.email.value,function(t,a){return"1"==t?(e.submit(),!0):($("#errorMensagem").show(),$("#errorMensagem").text("Login inexistente!"),!1)})}function gerarRelatorioPDF(){$.get("/usuario/tablerelatorio?dispositivoRelatorio="+$("#dispositivoRelatorio").val()+"&mensagemRelatorio="+$("#mensagemNoFiltroRelatorio").val()+"&dataRelatorio1="+$("#dataRelatorio1").val()+"&dataRelatorio2="+$("#dataRelatorio2").val(),function(e){initPDF(e)})}function VerificaRelatorio(){if(!$("#dataRelatorio1").val()||!$("#dataRelatorio2").val())return $("#quandoClica").removeClass("loader"),alertify.alert("","Informa ao menos um intervalo."),!1;$("#quandoClica").addClass("loader"),$("#tableListaRelatorio").show(),$("#btnDownloadRelatorioCSV").show(),$("#btnDownloadKML").show(),$("#btnDownloadRelatorioPDF").show(),$("#removeTabela").show();var e=$("#tableListaRelatorio").DataTable();e.destroy(),$("#tableListaRelatorio").empty(),$("#tableListaRelatorio").append("<thead> <tr> <th> Nome </th> <th> Dispositivo </th><th> Mensagem </th> <th> Latitude </th> <th> Longitude </th> <th> Data </th> <th> hora </th></tr> </thead>"),$.ajax({url:"/usuario/tablerelatorio?dispositivoRelatorio="+$("#dispositivoRelatorio").val()+"&mensagemRelatorio="+$("#mensagemNoFiltroRelatorio").val()+"&dataRelatorio1="+$("#dataRelatorio1").val()+"&dataRelatorio2="+$("#dataRelatorio2").val(),method:"get",datatype:"json",success:function(t){e=$("#tableListaRelatorio").dataTable({pageLength:10,responsive:!0,bLengthChange:!1,oLanguage:{sProcessing:"Aguarde enquanto os dados são carregados ...",sLengthMenu:"Mostrar _MENU_ registros por pagina",sZeroRecords:"Nenhum registro correspondente encontrado",sInfoEmtpy:"Exibindo 0 a 0 de 0 registros",sInfo:"Exibindo de _START_ a _END_ de _TOTAL_ registros",sInfoFiltered:"",sSearch:"Procurar",oPaginate:{sFirst:"Primeiro",sPrevious:"Anterior",sNext:"Próximo",sLast:"Último"}},data:t,columns:[{data:"userDispositivo[0].nome",defaultContent:""},{data:"dispositivo.nome",defaultContent:""},{data:"mensagem"},{data:"lat",defaultContent:""},{data:"lng",defaultContent:""},{data:"data"},{data:"hora"}]})},complete:function(){$("#quandoClica").removeClass("loader")}})}function gerarKML(){$("#tlcRelatorio").attr("action","/usuario/gerarkml"),$("#tlcRelatorio").submit()}function gerarCSV(){$("#tlcRelatorio").attr("action","/usuario/gerarelatorio"),$("#tlcRelatorio").submit()}function AdicionarQuebraDeLinha(e){return e.split("Œ").join("\n")}function mascaraTelefone_DataList(){var e=document.getElementById("editarDispositivoUser");e.setAttribute("list","dispositivosDataListEditar");var t=document.createElement("datalist");t.setAttribute("id","dispositivosDataListEditar"),e.appendChild(t),$.get("/dispositivo/cadatrados",preencherDataListEditar);var a;$(".telefone").on("input propertychange",function(){console.log("Carregou o Script!");var e=$(this).val();if(e=e.replace(/[^\d]/g,""),e.length>0){if(e="("+e,e.length>3&&(e=[e.slice(0,3),") ",e.slice(3)].join("")),e.length>12)if(e.length>13){var t=e.substring(0,7);"(08) 00"==t?(e=e.replace("(","").replace(")","").replace("-","").replace(/\s+/,""),e=e.substr(0,4)+" "+e.substr(4)):e=[e.slice(0,10),"-",e.slice(10)].join("")}else e=[e.slice(0,9),"-",e.slice(9)].join("");e.length>15&&e.length<=16?(e=e.replace("(","").replace(")","").replace("-","").replace(/\s+/,""),e=e.substr(0,2)+" "+e.substr(2),e=e.substr(0,5)+" "+e.substr(5),e=e.substr(0,10)+"-"+e.substr(10),a="+"+e,e=a):e.length>16&&(a?(e=a,a=!1):e=e.substr(0,16))}$(this).val(e)})}function startTime(){var e=document.getElementById("tempoAtendimento"),t="0",a="0",o="0";setInterval(function(){o++,60==o&&(o=0,a++),o<10&&(o="0"+o),60==a&&(a=0,t++),a.toString().length<=1&&(a="0"+a),console.log(a.length),e.innerHTML=t+":"+a+":"+o},1e3)}function upperCaseF(e){setTimeout(function(){e.value=e.value.toUpperCase()},1)}function lowerCaseF(e){setTimeout(function(){e.value=e.value.toLowerCase()},1)}function gerarTabela(e){function t(e){var t=e.children[3].textContent.split(" ");mostrarMarker(e.children[1].textContent,t[1],e.children[2].textContent)}for(var a=document.getElementById("tablealarmesbody"),o=a.rows.length,n=0;n<o;n++)a.deleteRow(n),o--,n--;$.each(e,function(e,t){t.visto?status="atendido":status="Em Aberto",void 0!==t.userDispositivo[0]?$("#tablealarmesbody").append('<tr><td> <a href="#"  title="Editar Usuario",   data-toggle="modal" data-target="#modalUsuario"  onclick=selPersona(\''+JSON.stringify(t.userDispositivo[0],substitui)+'\'); style="color:black">'+t.userDispositivo[0].nome+"</a></td><td>"+t.dispositivo.nome+"</td><td>"+t.mensagem+"</td><td>"+t.data+" "+t.hora+'</td><td><a href= "#" data-toggle="modal" data-target="#modalAtendimento" onclick="startTime();">'+status+"</a></td></tr>"):void 0!==t.nome?$("#tablealarmesbody").append('<tr><td><a href="#"  title="Editar Usuario",   data-toggle="modal" data-target="#modalUsuario"  onclick=selPersona(\''+JSON.stringify(t.user[0],substitui)+'\'); style="color:black">'+t.nome[0]+"</td><td>"+t.dispositivo.nome+"</td><td>"+t.mensagem+"</td><td>"+t.data+" "+t.hora+'</td><td><a href= "#" data-toggle="modal" data-target="#modalAtendimento" onclick="startTime();">'+status+"</a></td> </tr>"):$("#tablealarmesbody").append("<tr><td> Sem Usuário</td><td>"+t.dispositivo.nome+"</td><td>"+t.mensagem+"</td><td>"+t.data+" "+t.hora+"</td><td><button value="+status+" </button></td>  </tr>")}),$("#tablealarmesbody tr").on("click",function(){t(this)})}function getPosition(e,t){navigator.geolocation.getCurrentPosition(function(a,o){if(a)throw a;t=o.coords.longitude,e=o.coords.latitude,console.log("Latitude "+o.coords.latitude+"\nLongitude "+o.coords.longitude)})}var source,liberaAtualizacao,senhaCerta=!1,clienteParaCombo;MudarActionEditar=function(){document.tlEditarUser.action="/usuario/atualizar/"+document.getElementById("idUsuarioTlEditar").value},VoltaParaInicio=function(){document.getElementById("nomeNoFiltro").value="",document.getElementById("mensagemNoFiltro").value="",document.getElementById("datepicker").value="",document.formFiltro.action="/principal"},mudarActionClienteExcluir=function(e){confirm("Deseja excluir usuáio?")&&(document.tlClienteOpcoes.action="/cliente/delete/"+e)},mudarActionClienteEditar=function(e){document.tlClienteOpcoes.action="/cliente/edit/"+e},alterar=function(){document.getElementById("btnencaminha").href="/usuario/editar/"+document.getElementById("idUsuario").value},sairAda=function(){alertify.confirm("","Realmente deseja sair do ADA ?",function(){source.close(),$(location).attr("href","/logout")},function(){}).set("labels",{ok:"Sim",cancel:"Não"})},MudarAction=function(){document.modalUser.action="/usuario/editar/"+document.getElementById("idUsuario").value},selPersona=function(e){var t=e.replace(/\u20BB/gm," "),a=JSON.parse(t);document.getElementById("dispositivoUserModal").value=a.dispositivo,document.getElementById("nomeUserModal").value=a.nome,document.getElementById("SobrenomeUserModal").value=a.sobrenome,document.getElementById("telefone").value=a.telefone,document.getElementById("usercelular").value=a.celular,document.getElementById("cpf").value=a.cpf,document.getElementById("DataNascimento").value=a.data_nascimento,document.getElementById("rua").value=a.Endereco.rua,document.getElementById("enderecoNumero").value=a.Endereco.numero,document.getElementById("bairro").value=a.Endereco.bairro,document.getElementById("showComplemento").value=a.Endereco.complemento,document.getElementById("cidade").value=a.Endereco.cidade,document.getElementById("cep").value=a.Endereco.cep,document.getElementById("uf").value=a.Endereco.uf,document.getElementById("pontoReferencia").value=a.Endereco.ponto_referencia,document.getElementById("peso").value=a.peso,document.getElementById("sexo").value=a.sexo,document.getElementById("altura").value=a.altura,document.getElementById("modaltipoSanguineo").value=a.tipo_sanguineo,document.getElementById("medico").value=a.Medico.nome_medico,document.getElementById("telConsultorio").value=a.Medico.tel_consultorio,document.getElementById("telMedicoResidencial").value=a.Medico.tel_residencial,document.getElementById("celMedico").value=a.Medico.celular_medico,document.getElementById("hospitalPreferencia").value=a.Medico.hospital_preferencia,document.getElementById("planoSaude").value=a.Medico.plano_saude,document.getElementById("modelidentPlano").value=a.Medico.plano_identi,document.getElementById("telefonePlano").value=a.Medico.plano_telefone,document.getElementById("modalTelefoneHospital").value=a.Medico.tel_hospital,document.getElementById("nome1").value=a.Contato1.nome1,document.getElementById("chave1").checked=a.Contato1.chaves1,document.getElementById("relacao1").value=a.Contato1.relacao1,document.getElementById("telResidencia1").value=a.Contato1.telefone1_residencial,document.getElementById("telComercial1").value=a.Contato1.telefone1_comercial,document.getElementById("telCelular1").value=a.Contato1.telefone1_celular,document.getElementById("nome2").value=a.Contato2.nome2,document.getElementById("chave2").checked=a.Contato2.chaves2,document.getElementById("relacao2").value=a.Contato2.relacao2,document.getElementById("telResidencia2").value=a.Contato2.telefone2_residencial,document.getElementById("telComercial2").value=a.Contato2.telefone2_comercial,document.getElementById("telCelular2").value=a.Contato2.telefone2_celular,document.getElementById("nome3").value=a.Contato3.nome3,document.getElementById("chave3").checked=a.Contato3.chaves3,document.getElementById("relacao3").value=a.Contato3.relacao3,document.getElementById("telResidencia3").value=a.Contato3.telefone3_residencial,document.getElementById("telComercial3").value=a.Contato3.telefone3_comercial,document.getElementById("telCelular3").value=a.Contato3.telefone3_celular,document.getElementById("nome4").value=a.Contato4.nome4,document.getElementById("chave4").checked=a.Contato4.chaves4,document.getElementById("relacao4").value=a.Contato4.relacao4,document.getElementById("telResidencia4").value=a.Contato4.telefone4_residencial,document.getElementById("telComercial4").value=a.Contato4.telefone4_comercial,document.getElementById("telCelular4").value=a.Contato4.telefone4_celular,document.getElementById("nome5").value=a.Contato5.nome5,document.getElementById("chave5").checked=a.Contato5.chaves5,document.getElementById("relacao5").value=a.Contato5.relacao5,document.getElementById("telResidencia5").value=a.Contato5.telefone5_residencial,document.getElementById("telComercial5").value=a.Contato5.telefone5_comercial,document.getElementById("telCelular5").value=a.Contato5.telefone5_celular,document.getElementById("audicao").checked=a.HistoricoMedico.audicao,document.getElementById("visao").checked=a.HistoricoMedico.visao,document.getElementById("fala").checked=a.HistoricoMedico.fala,document.getElementById("respiracao").checked=a.HistoricoMedico.respiracao,document.getElementById("coracao").checked=a.HistoricoMedico.coracao,document.getElementById("pressao").checked=a.HistoricoMedico.pressao,document.getElementById("diabete").checked=a.HistoricoMedico.diabete,document.getElementById("artrite").checked=a.HistoricoMedico.artrite,document.getElementById("derrame").checked=a.HistoricoMedico.derrame,document.getElementById("riscoQueda").checked=a.HistoricoMedico.riscoQueda,document.getElementById("outro").value=a.HistoricoMedico.outro,document.getElementById("idUsuario").value=a._id,"VLI"==a.dispositivo.slice(0,3)&&(document.getElementById("mensagemVLI").hidden=!1),document.getElementById("instruEspeciais").value=AdicionarQuebraDeLinha(a.instrucoes_especiais),document.getElementById("alergia").value=AdicionarQuebraDeLinha(a.alergia),document.getElementById("medicamentoEmUso").value=AdicionarQuebraDeLinha(a.medicamento_em_uso),document.getElementById("observacaoModal").value=AdicionarQuebraDeLinha(a.observacao)},$(document).ready(function(){$("#avisa_notificacao").mouseenter(function(){$.get("/principal/atendimento",function(e){$("#qtdSosAjuda").text(e)})}),$('[data-toggle="popover"]').popover(),$("[name^=nomeDisposi]").blur(function(){$.get("/usuario/verificar?dispositivo="+$("[name^=nomeDisposi]").val(),possuiDispositivo)})});var dispositivoPossuiUsuario;$("[name^=identificadorCliente]").ready(function(){function e(e,t){var a=[];$.each(e,function(e,t){a[e]=document.createElement("option"),$(a[e]).attr({value:t}),$(a[e]).append(t),$("select[name=identificadorClienteCreate]").append(a[e])})}function t(e,t){var a=[];$.each(e,function(e,t){a[e]=document.createElement("option"),$(a[e]).attr({value:t}),$(a[e]).append(t),null!==document.getElementById("identificadorClienteEditar")&&($("select[name=identificadorClienteEditar]").append(a[e]),document.getElementById("identificadorClienteEditar").value=clienteParaCombo)})}$.getJSON("/cliente/combo",e),$.getJSON("/cliente/combo",t)}),$(document).ready(function(){function e(){$("[name^=rua]").val(""),$("[name^=bairro]").val(""),$("[name^=cidade]").val(""),$("[name^=uf]").val("")}$("[name=cep]").blur(function(){var t=$(this).val().replace(/\D/g,"");if(""!==t){/^[0-9]{8}$/.test(t)?($("[name^=rua]").val("..."),$("[name^=bairro]").val("..."),$("[name^=cidade]").val("..."),$("[name^=uf]").val("..."),$.getJSON("//viacep.com.br/ws/"+t+"/json/?callback=?",function(t){"erro"in t?(e(),alertify.alert("Ops!","CEP não encontrado.")):($("[name^=rua]").val(t.logradouro),$("[name^=bairro]").val(t.bairro),$("[name^=cidade]").val(t.localidade),$("[name^=uf]").val(t.uf))})):(e(),alertify.alert("Ops!","Formato de CEP inválido."))}else e()})}),$(document).ready(function(){$("#myModal1").ready(function(){$("[name=EsconderDados]").hide()});var e=!0;$("[name=mostraOculta]").click(function(){$("[name=EsconderDados]").toggle(),e?($("[name=mostraOculta]").val("ocultar"),e=!1,$(this).find("i").removeClass("glyphicon-arrow-down"),$(this).find("i").addClass("glyphicon-arrow-up"),$(this).find("span").text("Ocultar")):($("[name=mostraOculta]").val("mostrar"),e=!0,$(this).find("i").removeClass("glyphicon-arrow-up"),$(this).find("i").addClass("glyphicon-arrow-down"),$(this).find("span").text("Mostrar"))})}),source=new EventSource("/principal/atualizar"),source.addEventListener("message",function(e){"true"==liberaAtualizacao&&"N"!=e.data&&InitMap(e.data)},!1),$(document).ready(function(){liberaAtualizacao=document.getElementById("podeAtualizar").value,"true"==liberaAtualizacao&&$("#botaoLipaPesquisa").hide(),$("#mostrar_notificacao").hide(),Notification.requestPermission(function(e){console.log(e)})}),Notification.requestPermission(function(e){console.log(e)});var request=null;$(document).ready(function(){$("#errorMensagem").hide(),$("#tableListaRelatorio").hide(),$("#btnDownloadRelatorioCSV").hide(),$("#btnDownloadKML").hide(),$("#btnDownloadRelatorioPDF").hide(),$("#removeTabela").hide()}),$(document).ready(function(){$(function(){$("[name^=dat]").datepicker({dateFormat:"dd/mm/yy",dayNamesMin:["Dom","Seg","Ter","Qua","Qui","Sex","Sab"],monthNames:["Janeiro","Fevereiro","Março","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"],dayNames:["Domingo","Segunda","Terça","Quarta","Quinta","Sexta","Sábado"],dayNamesShort:["Dom","Seg","Ter","Qua","Qui","Sex","Sáb","Dom"],changeYear:!0})})}),$(function(){$("[name^=cep]").mask("99999-999"),$("[name^=cpf]").mask("999.999.999-99"),$("[name^=data]").mask("99/99/9999")}),$("#lista_cliente").ready(function(){$.ajax({url:"/cliente/listcliente",method:"get",datatype:"json",success:function(e){$("#lista_cliente").dataTable({oLanguage:{sEmptyTable:"Nenhum registro encontrado",sProcessing:"Aguarde enquanto os dados são carregados ...",sLengthMenu:"Mostrar _MENU_ registros por pagina",sZeroRecords:"Nenhum registro correspondente encontrado",sInfoEmtpy:"Exibindo 0 a 0 de 0 registros",sInfo:"Exibindo de _START_ a _END_ de _TOTAL_ registros",sInfoFiltered:"",sSearch:"Procurar",oPaginate:{sFirst:"Primeiro",sPrevious:"Anterior",sNext:"Próximo",sLast:"Último"}},bLengthChange:!1,responsive:!0,iDisplayLength:10,data:e,columns:[{data:"nome"},{data:"login"},{data:"cliente"},{data:"_id",searchable:!1,orderable:!1,render:function(e){return'<a href="/cliente/show/'+e+'" title="Visualizar" class="icone" > <span class="glyphicon glyphicon-pencil" style="margin-left: 25px;"> Editar  </span></a>'}}]})},complete:function(){$("#loadingUsuario").remove()}})}),$("#tableListaUser").ready(function(){$.ajax({url:"/usuario/listauser",method:"get",datatype:"json",success:function(e){$("#tableListaUser").dataTable({pageLength:10,responsive:!0,bLengthChange:!1,oLanguage:{sProcessing:"Aguarde enquanto os dados são carregados ...",sLengthMenu:"Mostrar _MENU_ registros por pagina",sZeroRecords:"Nenhum registro correspondente encontrado",sInfoEmtpy:"Exibindo 0 a 0 de 0 registros",sInfo:"Exibindo de _START_ a _END_ de _TOTAL_ registros",sInfoFiltered:"",sSearch:"Procurar",oPaginate:{sFirst:"Primeiro",sPrevious:"Anterior",sNext:"Próximo",sLast:"Último"}},data:e,columns:[{data:"nome"},{data:"sobrenome"},{data:"cliente"},{data:"dispositivo"},{data:"_id",searchable:!1,orderable:!1,render:function(e){return'<a href="/usuario/editar/'+e+'" class="icone"> <span class="glyphicon glyphicon-pencil">  Editar </span></a>'}}]})},complete:function(){$("#loadingUsuario").remove()}})}),$(document).ready(function(){$("#controlDevice").click(function(e){$(this).toggleClass("close_device"),$(".panel_device").toggleClass("show_device")}),$("#fecharModal").click(function(){$(".close").trigger("click")}),$(".box_icone_nav").click(function(e){$(this).toggleClass("menufixo")});var e=!0;$("#control-grid").click(function(t){$(".coluna-control").toggleClass("disable-coluna"),e?(e=!1,$(this).find("i").removeClass("glyphicon-eye-open"),$(this).find("i").addClass("glyphicon-eye-close"),$(this).find("span").text("Ocultar todos os campos")):(e=!0,$(this).find("i").removeClass("glyphicon-eye-close"),$(this).find("i").addClass("glyphicon-eye-open"),$(this).find("span").text("Exibir todos os campos"))}),qtdMensagens=parseInt($("#qtdSosAjuda").text()),0===qtdMensagens&&$(".qtd_notificacao").css("display","none"),qtdMensagens<=1?$("#controlPluralMensagem").text(" Emergência"):$("#controlPluralMensagem").text(" Emergências")});
=======
function alerta(e){return toastr.options={closeButton:!0,debug:!1,newestOnTop:!1,progressBar:!0,positionClass:"toast-top-center",preventDuplicates:!1,onclick:null,showDuration:"2000",hideDuration:"2000",timeOut:"4000",extendedTimeOut:"1000",showEasing:"swing",hideEasing:"linear",showMethod:"fadeIn",hideMethod:"fadeOut"},senhaCerta?(toastr.info("Senha atual inválida !"),!1):document.modalTrocaSenha.senha1.value==document.modalTrocaSenha.senha2.value?(toastr.success("Senha Alterada com sucesso!"),!0):(toastr.error("Confirmação de senha incorreta !"),!1)}function verificaSenhaModal(e){$.get("/cliente/pegasenha?login="+e+"&senha="+$("#senhaAtual").val(),function(e){"TRUE"!=e&&(senhaCerta=!0),console.log(e)})}function desassociar(){alertify.confirm("","Deseja excluir o usuário?",function(){document.tlEditarUser.action="/usuario/desassociar/"+document.getElementById("Tl_editarUsuario_id_Usuario").value,document.tlEditarUser.submit(),$("#quandoClica").addClass("loader")},function(){}).set("labels",{ok:"Sim",cancel:"Não"})}function substitui(e,t){return"string"==typeof t?t.replace(/\s/gm,"₻"):t}function possuiDispositivo(e,t){"TRUE"==e?(alertify.alert("","Este dispositivo já possui um usuário"),dispositivoPossuiUsuario=!0):"FALSE"==e&&(dispositivoPossuiUsuario=!1)}function AdicionarQuebraDeLinha(e){return e.split("Œ").join("\n")}function validarData(e){var t=[];(t=e.value.split("/"))[0]>31||t[0]<0?alertify.alert("","Data Invalida dia maior que 31 ou menor que 0."):(t[1]>12||t[1]<0)&&alertify.alert("","Data Invalida mês maior que 12 ou menor que 0.")}function validarCamposRelatorio(e){var t=0,a="";if(""==e.dispositivoRelatorio.value&&""==e.mensagemRelatorio.value&&""==e.dataRelatorio1.value&&""==e.dataRelatorio2.value?(t++,a+="Não é possível fazer uma busca vazia por favor informe ao menos um intervalo."):""!=e.dataRelatorio1.value&&""!=e.dataRelatorio2.value||(t++,a+="Por favor, informe o intevalo da busca."),t>0)return alertify.alert("Campos necessários",a),!1;e.submit()}function validarEditarCliente(e){var t=0,a="";if(""===e.nome.value&&(t++,a+="* O Nome está em branco. </br>"),""===e.login.value&&(t++,a+="* O login está em branco. </br>"),t>0)return alertify.alert("Campos Obrigatórios!",a),$("#quandoClica").remove(),!1;e.submit()}function validarResetSenha(e){var t=0,a="";if(""===e.senha.value&&(t++,a+="* Por favor informe a nova senha.</br>"),""===e.confirmSenha.value&&(t++,a+="* Por favor informe a confirmação da nova senha.</br>"),e.confirmSenha.value!=e.senha.value&&(t++,a+="* Senha e confimação de senha estão diferentes"),t>0)return alertify.alert("Campos Obrigatórios!",a),$("#quandoClica").remove(),!1;e.submit()}function validarCadastroCliente(e){var t=0,a="";if(""===e.cliente.value&&(t++,a+="* Por favor informe o cliente.</br>"),""===e.nome.value&&(t++,a+="* Por favor informe o nome do cliente.</br>"),""===e.login.value&&(t++,a+="* Por favor informe o Login.</br>"),""===e.senha.value&&(t++,a+="* Por favor informe a senha.</br>"),""===e.confirmSenha.value&&(t++,a+="* Por favor confirme a senha.</br>"),e.senha.value!=e.confirmSenha.value&&(t++,a+="* Senha e confimação de senha estão diferentes.</br>"),t>0)return alertify.alert("Campos Obrigatórios!",a),$("#quandoClica").remove(),!1;e.submit()}function validarCampos(e){var t=0,a="";if(dispositivoPossuiUsuario&&(t++,a+="* Informe um dispositivo válido.  </br>\n"),""===e.NomeUsuario.value&&(t++,a+="* Informe o nome.  </br>\n"),""===e.dispositivoUser.value&&(e.dispositivoUser.value="Sem Dispositivo"),""===e.SobrenomeUsuario.value&&(t++,a+="* Informe o sobrenome.  </br>\n"),""===e.usuarioResidencia.value&&""===e.usuarioceluar.value&&(t++,a+="* Informe algum telefone do usuário. </br>\n"),(""===e.tlCreateNome1.value||""===e.tlCreateNome2.value||""===e.tlCreateNome3.value||""===e.telResidencia1.value&&""===e.telComercial1.value&&""===e.telCelular1.value||""===e.telResidencia2.value&&""===e.telComercial2.value&&""===e.telCelular2.value||""===e.telResidencia3.value&&""===e.telComercial3.value&&""===e.telCelular3.value)&&(t++,a+="* Informe ao menos três contatos para o usuário.  \n"),t>0)return alertify.alert("Campos Obrigatórios!",a),$("#quandoClica").remove(),!1;e.submit()}function validarEditarCampos(e){var t=0,a="";if(dispositivoPossuiUsuario&&(t++,a+="* Informe um dispositivo válido.  </br>\n"),""===e.editarNomeUsuario.value&&(t++,a+="* Informe o nome.  </br>\n"),""===e.editarSobrenomeUsuario.value&&(t++,a+="* Informe o sobrenome.  </br>\n"),""===e.editarUsuarioResidencia.value&&""===e.editarUserCelular.value&&(t++,a+="*  Informe algum telefone do usuário.  </br>\n"),(""===e.editarContato1Nome1.value||""===e.editarNome2.value||""===e.editarNome3.value||""===e.editartelResidencia1.value&&""===e.editartelComercial1.value&&""===e.editartelCelular1.value||""===e.editartelResidencia2.value&&""===e.editartelComercial2.value&&""===e.editartelCelular2.value||""===e.editartelResidencia3.value&&""===e.editartelComercial3.value&&""===e.editartelCelular3.value)&&(t++,a+="* Informe ao menos três contatos do usuário.  </br>\n"),t>0)return alertify.alert("",a),$("#quandoClica").remove(),!1;e.submit()}function apaganotifi(){$("#mostrar_notificacao").hide()}function NotificacaoSOS(e){new Notification("Chegou um SOS!",{dir:"auto",icon:"images/SOS_B1.png",lang:"",vibrate:"[200, 100, 200]",body:"Olá, por favor entre em contato com o usuário do dispositivo "+e,tag:"tag"})}function NotificacaoAjuda(e){new Notification("Chegou um novo Alarme!",{dir:"auto",icon:"images/Alarme_B1.png",lang:"",vibrate:"[200, 100, 200]",body:"Olá, por favor entre em contato com o usuário do dispositivo "+e,tag:"tag"}).onclick=function(){}}function createRequest(){try{request=new XMLHttpRequest}catch(e){try{request=new ActiveXObject("Msxml2.XMLHTTP")}catch(e){try{request=new ActiveXObject("Microsoft.XMLHTTP")}catch(e){request=null}}}null===request&&alert("Error creating request object!")}function getInformacaoQualquer(e){createRequest();var t="/principal/viu?nome="+e+"&visto=true";request.open("POST",t,!0),request.onreadystatechange=atualizaPagina,request.send()}function atualizaPagina(){if(4==request.readyState)request.responseText}function testeCarregando(){$("#quandoClica").addClass("loader")}function validarLoginModal(e){if(0==grecaptcha.getResponse().length)return $("#errorMensagem").show(),$("#errorMensagem").text("Captcha não marcado!"),!1;$.get("/cliente/temlogin?login="+e.email.value,function(t,a){return"1"==t?(e.submit(),!0):($("#errorMensagem").show(),$("#errorMensagem").text("Login inexistente!"),!1)})}function gerarRelatorioPDF(){$.get("/usuario/tablerelatorio?dispositivoRelatorio="+$("#dispositivoRelatorio").val()+"&mensagemRelatorio="+$("#mensagemNoFiltroRelatorio").val()+"&dataRelatorio1="+$("#dataRelatorio1").val()+"&dataRelatorio2="+$("#dataRelatorio2").val(),function(e){initPDF(e)})}function VerificaRelatorio(){if(!$("#dataRelatorio1").val()||!$("#dataRelatorio2").val())return $("#quandoClica").removeClass("loader"),alertify.alert("","Informa ao menos um intervalo."),!1;$("#quandoClica").addClass("loader"),$("#tableListaRelatorio").show(),$("#btnDownloadRelatorioCSV").show(),$("#btnDownloadKML").show(),$("#btnDownloadRelatorioPDF").show(),$("#removeTabela").show(),$("#btnDownloadSHP").show();var e=$("#tableListaRelatorio").DataTable();e.destroy(),$("#tableListaRelatorio").empty(),$("#tableListaRelatorio").append("<thead> <tr> <th> Nome </th> <th> Dispositivo </th><th> Mensagem </th> <th> Latitude </th> <th> Longitude </th> <th> Data </th> <th> hora </th></tr> </thead>"),$.ajax({url:"/usuario/tablerelatorio?dispositivoRelatorio="+$("#dispositivoRelatorio").val()+"&mensagemRelatorio="+$("#mensagemNoFiltroRelatorio").val()+"&dataRelatorio1="+$("#dataRelatorio1").val()+"&dataRelatorio2="+$("#dataRelatorio2").val(),method:"get",datatype:"json",success:function(t){e=$("#tableListaRelatorio").dataTable({pageLength:10,responsive:!0,bLengthChange:!1,oLanguage:{sProcessing:"Aguarde enquanto os dados são carregados ...",sLengthMenu:"Mostrar _MENU_ registros por pagina",sZeroRecords:"Nenhum registro correspondente encontrado",sInfoEmtpy:"Exibindo 0 a 0 de 0 registros",sInfo:"Exibindo de _START_ a _END_ de _TOTAL_ registros",sInfoFiltered:"",sSearch:"Procurar",oPaginate:{sFirst:"Primeiro",sPrevious:"Anterior",sNext:"Próximo",sLast:"Último"}},data:t,columns:[{data:"userDispositivo[0].nome",defaultContent:""},{data:"dispositivo.nome",defaultContent:""},{data:"mensagem"},{data:"lat",defaultContent:""},{data:"lng",defaultContent:""},{data:"data"},{data:"hora"}]})},complete:function(){$("#quandoClica").removeClass("loader")}})}function gerarKML(){$("#tlcRelatorio").attr("action","/usuario/gerarkml"),$("#tlcRelatorio").submit()}function gerarCSV(){$("#tlcRelatorio").attr("action","/usuario/gerarelatorio"),$("#tlcRelatorio").submit()}function gerarSHP(){$("#tlcRelatorio").attr("action","/usuario/gerarSHP"),$("#tlcRelatorio").submit()}function upperCaseF(e){setTimeout(function(){e.value=e.value.toUpperCase()},1)}function lowerCaseF(e){setTimeout(function(){e.value=e.value.toLowerCase()},1)}function gerarTabela(e){for(var t=document.getElementById("tablealarmesbody"),a=t.rows.length,o=0;o<a;o++)t.deleteRow(o),a--,o--;$.each(e,function(e,t){void 0!==t.userDispositivo[0]?$("#tablealarmesbody").append('<tr><td> <a href="#"  title="Editar Usuario",   data-toggle="modal" data-target="#modalUsuario"  onclick=selPersona(\''+JSON.stringify(t.userDispositivo[0],substitui)+'\'); style="color:black">'+t.userDispositivo[0].nome+"</a></td><td>"+t.dispositivo.nome+"</td><td>"+t.mensagem+"</td><td>"+t.data+" "+t.hora+"</td> </tr>"):void 0!==t.nome?$("#tablealarmesbody").append('<tr><td><a href="#"  title="Editar Usuario",   data-toggle="modal" data-target="#modalUsuario"  onclick=selPersona(\''+JSON.stringify(t.user[0],substitui)+'\'); style="color:black">'+t.nome[0]+"</td><td>"+t.dispositivo.nome+"</td><td>"+t.mensagem+"</td><td>"+t.data+" "+t.hora+"</td> </tr>"):$("#tablealarmesbody").append("<tr><td> Sem Usuário</td><td>"+t.dispositivo.nome+"</td><td>"+t.mensagem+"</td><td>"+t.data+" "+t.hora+"</td> </tr>")}),$("#tablealarmesbody tr").on("click",function(){!function(t){var a=t.children[3].textContent.split(" ");mostrarMarker(t.children[1].textContent,a[1],t.children[2].textContent,e)}(this)})}function editarDados(e){var t=JSON.parse(e);document.getElementById("Tl_editarUsuario_id_Usuario").value=t._id,document.getElementById("editarDispositivoUser").value=t.dispositivo,"LIFELINK"!=document.getElementById("podeEditarDispositivo").value&&"ATHENE"!=document.getElementById("podeEditarDispositivo").value||(document.getElementById("editarDispositivoUser").disabled=!1),null!==document.getElementById("identificadorClienteEditar")&&(document.getElementById("identificadorClienteEditar").value=t.cliente,clienteParaCombo=t.cliente),document.getElementById("tl_editar_identificador_usuario").value=t.cliente,document.getElementById("editarNomeUsuario").value=t.nome,document.getElementById("editarSobrenomeUsuario").value=t.sobrenome,document.getElementById("editarUsuarioResidencia").value=t.telefone,document.getElementById("editarUserCelular").value=t.celular,document.getElementById("editarCPF").value=t.cpf,document.getElementById("editardatanascimento").value=t.data_nascimento,document.getElementById("editarRua").value=t.Endereco.rua,document.getElementById("editarNumeroEndereco").value=t.Endereco.numero,document.getElementById("editarBairro").value=t.Endereco.bairro,document.getElementById("editarCidade").value=t.Endereco.cidade,document.getElementById("editarComplemento").value=t.Endereco.complemento,document.getElementById("editarCep").value=t.Endereco.cep,document.getElementById("editarUf").value=t.Endereco.uf,document.getElementById("editarPontodeReferencia").value=t.Endereco.ponto_referencia,document.getElementById("editarPeso").value=t.peso,document.getElementById("editarSexo").value=t.sexo,document.getElementById("editarAltura").value=t.altura,document.getElementById("editarTipoSanguineo").value=t.tipo_sanguineo,document.getElementById("editarMedico").value=t.Medico.nome_medico,document.getElementById("editartelconsultorio").value=t.Medico.tel_consultorio,document.getElementById("editarTelResidenciaMedico").value=t.Medico.tel_residencial,document.getElementById("editarMedicoCelular").value=t.Medico.celular_medico,document.getElementById("editartelefoneHospital").value=t.Medico.tel_hospital,document.getElementById("editarHospitalPreferencia").value=t.Medico.hospital_preferencia,document.getElementById("editarPlano").value=t.Medico.plano_saude,document.getElementById("editarIdentiPlano").value=t.Medico.plano_identi,document.getElementById("editartelefonePlano").value=t.Medico.plano_telefone,document.getElementById("editarContato1Nome1").value=t.Contato1.nome1,document.getElementById("editarChave1").checked=t.Contato1.chaves1,document.getElementById("editarRelacao1").value=t.Contato1.relacao1,document.getElementById("editartelResidencia1").value=t.Contato1.telefone1_residencial,document.getElementById("editartelComercial1").value=t.Contato1.telefone1_comercial,document.getElementById("editartelCelular1").value=t.Contato1.telefone1_celular,document.getElementById("editarNome2").value=t.Contato2.nome2,document.getElementById("editarChave2").checked=t.Contato2.chaves2,document.getElementById("editarRelacao2").value=t.Contato2.relacao2,document.getElementById("editartelResidencia2").value=t.Contato2.telefone2_residencial,document.getElementById("editartelComercial2").value=t.Contato2.telefone2_comercial,document.getElementById("editartelCelular2").value=t.Contato2.telefone2_celular,document.getElementById("editarNome3").value=t.Contato3.nome3,document.getElementById("editarChave3").checked=t.Contato3.chaves3,document.getElementById("editarRelacao3").value=t.Contato3.relacao3,document.getElementById("editartelResidencia3").value=t.Contato3.telefone3_residencial,document.getElementById("editartelComercial3").value=t.Contato3.telefone3_comercial,document.getElementById("editartelCelular3").value=t.Contato3.telefone3_celular,document.getElementById("editarNome4").value=t.Contato4.nome4,document.getElementById("editarChave4").checked=t.Contato4.chaves4,document.getElementById("editarRelacao4").value=t.Contato4.relacao4,document.getElementById("editartelResidencia4").value=t.Contato4.telefone4_residencial,document.getElementById("editartelComercial4").value=t.Contato4.telefone4_comercial,document.getElementById("editartelCelular4").value=t.Contato4.telefone4_celular,document.getElementById("editarNome5").value=t.Contato5.nome5,document.getElementById("editarChave5").checked=t.Contato5.chaves5,document.getElementById("editarRelacao5").value=t.Contato5.relacao5,document.getElementById("editartelResidencia5").value=t.Contato5.telefone5_residencial,document.getElementById("editartelComercial5").value=t.Contato5.telefone5_comercial,document.getElementById("editartelCelular5").value=t.Contato5.telefone5_celular,document.getElementById("editarAudicao").checked=t.HistoricoMedico.audicao,document.getElementById("editarVisao").checked=t.HistoricoMedico.visao,document.getElementById("editarFala").checked=t.HistoricoMedico.fala,document.getElementById("editarRespiracao").checked=t.HistoricoMedico.respiracao,document.getElementById("editarCoracao").checked=t.HistoricoMedico.coracao,document.getElementById("editarPressao").checked=t.HistoricoMedico.pressao,document.getElementById("editarDiabete").checked=t.HistoricoMedico.diabete,document.getElementById("editarArtrite").checked=t.HistoricoMedico.artrite,document.getElementById("editarDerrame").checked=t.HistoricoMedico.derrame,document.getElementById("editarRiscoQueda").checked=t.HistoricoMedico.riscoQueda,document.getElementById("editarAlergias").value=AdicionarQuebraDeLinha(t.alergia),document.getElementById("editarmedicamentosUser").value=AdicionarQuebraDeLinha(t.medicamento_em_uso),document.getElementById("editarInstrucoes").value=AdicionarQuebraDeLinha(t.instrucoes_especiais),document.getElementById("editarOutro").value=t.HistoricoMedico.outro,document.getElementById("observacaoEdit").value=AdicionarQuebraDeLinha(t.observacao)}function voltarSemAlterar(e){temAlteracao?alertify.confirm("","Deseja voltar sem Salvar as alterações ?",function(){voltaParaListaUsuario()},function(){}).set("labels",{ok:"Sim",cancel:"Não"}):voltaParaListaUsuario()}function houveAlteracao(){temAlteracao=!0}function voltaParaPrincipal(){source.close(),$(location).attr("href","/principal"),$("#quandoClica").addClass("loader")}function voltaParaListaUsuario(){source.close(),$(location).attr("href","/usuario/lista"),$("#quandoClica").addClass("loader")}function getPosition(e,t){navigator.geolocation.getCurrentPosition(function(a,o){if(a)throw a;t=o.coords.longitude,e=o.coords.latitude,console.log("Latitude "+o.coords.latitude+"\nLongitude "+o.coords.longitude)})}var global,source,liberaAtualizacao,clienteParaCombo,senhaCerta=!1;VoltaParaInicio=function(){document.getElementById("nomeNoFiltro").value="",document.getElementById("mensagemNoFiltro").value="",document.getElementById("datepicker").value="",document.formFiltro.action="/principal"},mudarActionClienteExcluir=function(e){confirm("Deseja excluir usuáio?")&&(document.tlClienteOpcoes.action="/cliente/delete/"+e)},mudarActionClienteEditar=function(e){document.tlClienteOpcoes.action="/cliente/edit/"+e},alterar=function(){document.getElementById("btnencaminha").href="/usuario/editar/"+document.getElementById("idUsuario").value},sairAda=function(){alertify.confirm("","Realmente deseja sair do ADA ?",function(){source.close(),$(location).attr("href","/logout")},function(){}).set("labels",{ok:"Sim",cancel:"Não"})},$(document).ready(function(){$("#avisa_notificacao").mouseenter(function(){$.get("/principal/atendimento",function(e){$("#qtdSosAjuda").text(e)})}),$('[data-toggle="popover"]').popover(),$("[name^=nomeDisposi]").blur(function(){$.get("/usuario/verificar?dispositivo="+$("[name^=nomeDisposi]").val(),possuiDispositivo)})});var dispositivoPossuiUsuario;$(document).ready(function(){function e(){$("[name^=rua]").val(""),$("[name^=bairro]").val(""),$("[name^=cidade]").val(""),$("[name^=uf]").val("")}$("[name=cep]").blur(function(){var t=$(this).val().replace(/\D/g,"");if(""!==t){/^[0-9]{8}$/.test(t)?($("[name^=rua]").val("..."),$("[name^=bairro]").val("..."),$("[name^=cidade]").val("..."),$("[name^=uf]").val("..."),$.getJSON("//viacep.com.br/ws/"+t+"/json/?callback=?",function(t){"erro"in t?(e(),alertify.alert("Ops!","CEP não encontrado.")):($("[name^=rua]").val(t.logradouro),$("[name^=bairro]").val(t.bairro),$("[name^=cidade]").val(t.localidade),$("[name^=uf]").val(t.uf))})):(e(),alertify.alert("Ops!","Formato de CEP inválido."))}else e()})}),$(document).ready(function(){$("#myModal1").ready(function(){$("[name=EsconderDados]").hide()});var e=!0;$("[name=mostraOculta]").click(function(){$("[name=EsconderDados]").toggle(),e?($("[name=mostraOculta]").val("ocultar"),e=!1,$(this).find("i").removeClass("glyphicon-arrow-down"),$(this).find("i").addClass("glyphicon-arrow-up"),$(this).find("span").text("Ocultar")):($("[name=mostraOculta]").val("mostrar"),e=!0,$(this).find("i").removeClass("glyphicon-arrow-up"),$(this).find("i").addClass("glyphicon-arrow-down"),$(this).find("span").text("Mostrar"))})}),(source=new EventSource("/principal/atualizar")).addEventListener("message",function(e){"true"==liberaAtualizacao&&"N"!=e.data&&InitMap(e.data)},!1),$(document).ready(function(){"true"==(liberaAtualizacao=document.getElementById("podeAtualizar").value)&&$("#botaoLipaPesquisa").hide(),$("#mostrar_notificacao").hide(),Notification.requestPermission(function(e){console.log(e)})}),Notification.requestPermission(function(e){console.log(e)});var request=null;$(document).ready(function(){$("#errorMensagem").hide(),$("#tableListaRelatorio").hide(),$("#btnDownloadRelatorioCSV").hide(),$("#btnDownloadKML").hide(),$("#btnDownloadRelatorioPDF").hide(),$("#btnDownloadSHP").hide(),$("#removeTabela").hide()}),$(document).ready(function(){$(function(){$("[name^=dat]").datepicker({dateFormat:"dd/mm/yy",dayNamesMin:["Dom","Seg","Ter","Qua","Qui","Sex","Sab"],monthNames:["Janeiro","Fevereiro","Março","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"],dayNames:["Domingo","Segunda","Terça","Quarta","Quinta","Sexta","Sábado"],dayNamesShort:["Dom","Seg","Ter","Qua","Qui","Sex","Sáb","Dom"],changeYear:!0})})}),$(function(){$("#telefone").mask("(99) 9999-9999"),$("#telefone1").mask("(99) 9999-9999"),$("#UsuarioResidencia").mask("(99) 9999-9999"),$("#Usuariocelular").mask("(99) 99999-9999"),$("[name^=cep]").mask("99999-999"),$("[name^=celu]").mask("(99) 99999-9999"),$("[name^=Celu]").mask("(99) 99999-9999"),$("[name^=Tel]").mask("(99) 9999-9999"),$("[name^=tel]").mask("(99) 9999-9999"),$("[name^=tel]").mask("(99) 9999-9999"),$("[name^=cpf]").mask("999.999.999-99"),$("[name^=data]").mask("99/99/9999"),$("[name^=telComercial]").unmask()}),$("#lista_cliente").ready(function(){$.ajax({url:"/cliente/listcliente",method:"get",datatype:"json",success:function(e){$("#lista_cliente").dataTable({oLanguage:{sEmptyTable:"Nenhum registro encontrado",sProcessing:"Aguarde enquanto os dados são carregados ...",sLengthMenu:"Mostrar _MENU_ registros por pagina",sZeroRecords:"Nenhum registro correspondente encontrado",sInfoEmtpy:"Exibindo 0 a 0 de 0 registros",sInfo:"Exibindo de _START_ a _END_ de _TOTAL_ registros",sInfoFiltered:"",sSearch:"Procurar",oPaginate:{sFirst:"Primeiro",sPrevious:"Anterior",sNext:"Próximo",sLast:"Último"}},bLengthChange:!1,responsive:!0,iDisplayLength:10,data:e,columns:[{data:"nome"},{data:"login"},{data:"cliente"},{data:"_id",searchable:!1,orderable:!1,render:function(e){return console.log("cliente"),'<a href="/cliente/show/'+e+'" title="Visualizar" class="icone" > <span class="glyphicon glyphicon-pencil" style="margin-left: 25px;"> Editar  </span></a>'}}]})},complete:function(){$("#loadingUsuario").remove()}})});var tabelaUsuario;$("#tableListaUser").ready(function(){$.ajax({url:"/usuario/listauser",method:"get",datatype:"json",success:function(e){tabelaUsuario=$("#tableListaUser").dataTable({pageLength:10,responsive:!0,bLengthChange:!1,oLanguage:{sProcessing:"Aguarde enquanto os dados são carregados ...",sLengthMenu:"Mostrar _MENU_ registros por pagina",sZeroRecords:"Nenhum registro correspondente encontrado",sInfoEmtpy:"Exibindo 0 a 0 de 0 registros",sInfo:"Exibindo de _START_ a _END_ de _TOTAL_ registros",sInfoFiltered:"",sSearch:"Procurar",oPaginate:{sFirst:"Primeiro",sPrevious:"Anterior",sNext:"Próximo",sLast:"Último"}},data:e,columns:[{data:"nome"},{data:"sobrenome"},{data:"cliente"},{data:"dispositivo"},{data:"_id",searchable:!1,orderable:!1,render:function(e){return'<a href="/usuario/editar/'+e+'" class="icone"> <span class="glyphicon glyphicon-pencil">  Editar </span></a>'}}]})},complete:function(){$("#loadingUsuario").remove()}})});var temAlteracao=!1;MudarActionEditar=function(){document.tlEditarUser.action="/usuario/atualizar/"+document.getElementById("Tl_editarUsuario_id_Usuario").value},MudarAction=function(){document.modalUser.action="/usuario/editar/"+document.getElementById("dispositivoUserModal").value},selPersona=function(e){var t=e.replace(/\u20BB/gm," "),a=JSON.parse(t);document.getElementById("dispositivoUserModal").value=a.dispositivo,document.getElementById("nomeUserModal").value=a.nome,document.getElementById("SobrenomeUserModal").value=a.sobrenome,document.getElementById("telefone").value=a.telefone,document.getElementById("usercelular").value=a.celular,document.getElementById("cpf").value=a.cpf,document.getElementById("DataNascimento").value=a.data_nascimento,document.getElementById("rua").value=a.Endereco.rua,document.getElementById("enderecoNumero").value=a.Endereco.numero,document.getElementById("bairro").value=a.Endereco.bairro,document.getElementById("showComplemento").value=a.Endereco.complemento,document.getElementById("cidade").value=a.Endereco.cidade,document.getElementById("cep").value=a.Endereco.cep,document.getElementById("uf").value=a.Endereco.uf,document.getElementById("pontoReferencia").value=a.Endereco.ponto_referencia,document.getElementById("peso").value=a.peso,document.getElementById("sexo").value=a.sexo,document.getElementById("altura").value=a.altura,document.getElementById("modaltipoSanguineo").value=a.tipo_sanguineo,document.getElementById("observacaoModal").value=AdicionarQuebraDeLinha(a.observacao),document.getElementById("medico").value=a.Medico.nome_medico,document.getElementById("telConsultorio").value=a.Medico.tel_consultorio,document.getElementById("telMedicoResidencial").value=a.Medico.tel_residencial,document.getElementById("celMedico").value=a.Medico.celular_medico,document.getElementById("hospitalPreferencia").value=a.Medico.hospital_preferencia,document.getElementById("planoSaude").value=a.Medico.plano_saude,document.getElementById("modelidentPlano").value=a.Medico.plano_identi,document.getElementById("telefonePlano").value=a.Medico.plano_telefone,document.getElementById("modalTelefoneHospital").value=a.Medico.tel_hospital,document.getElementById("nome1").value=a.Contato1.nome1,document.getElementById("chave1").checked=a.Contato1.chaves1,document.getElementById("relacao1").value=a.Contato1.relacao1,document.getElementById("telResidencia1").value=a.Contato1.telefone1_residencial,document.getElementById("telComercial1").value=a.Contato1.telefone1_comercial,document.getElementById("telCelular1").value=a.Contato1.telefone1_celular,document.getElementById("nome2").value=a.Contato2.nome2,document.getElementById("chave2").checked=a.Contato2.chaves2,document.getElementById("relacao2").value=a.Contato2.relacao2,document.getElementById("telResidencia2").value=a.Contato2.telefone2_residencial,document.getElementById("telComercial2").value=a.Contato2.telefone2_comercial,document.getElementById("telCelular2").value=a.Contato2.telefone2_celular,document.getElementById("nome3").value=a.Contato3.nome3,document.getElementById("chave3").checked=a.Contato3.chaves3,document.getElementById("relacao3").value=a.Contato3.relacao3,document.getElementById("telResidencia3").value=a.Contato3.telefone3_residencial,document.getElementById("telComercial3").value=a.Contato3.telefone3_comercial,document.getElementById("telCelular3").value=a.Contato3.telefone3_celular,document.getElementById("nome4").value=a.Contato4.nome4,document.getElementById("chave4").checked=a.Contato4.chaves4,document.getElementById("relacao4").value=a.Contato4.relacao4,document.getElementById("telResidencia4").value=a.Contato4.telefone4_residencial,document.getElementById("telComercial4").value=a.Contato4.telefone4_comercial,document.getElementById("telCelular4").value=a.Contato4.telefone4_celular,document.getElementById("nome5").value=a.Contato5.nome5,document.getElementById("chave5").checked=a.Contato5.chaves5,document.getElementById("relacao5").value=a.Contato5.relacao5,document.getElementById("telResidencia5").value=a.Contato5.telefone5_residencial,document.getElementById("telComercial5").value=a.Contato5.telefone5_comercial,document.getElementById("telCelular5").value=a.Contato5.telefone5_celular,document.getElementById("audicao").checked=a.HistoricoMedico.audicao,document.getElementById("visao").checked=a.HistoricoMedico.visao,document.getElementById("fala").checked=a.HistoricoMedico.fala,document.getElementById("respiracao").checked=a.HistoricoMedico.respiracao,document.getElementById("coracao").checked=a.HistoricoMedico.coracao,document.getElementById("pressao").checked=a.HistoricoMedico.pressao,document.getElementById("diabete").checked=a.HistoricoMedico.diabete,document.getElementById("artrite").checked=a.HistoricoMedico.artrite,document.getElementById("derrame").checked=a.HistoricoMedico.derrame,document.getElementById("riscoQueda").checked=a.HistoricoMedico.riscoQueda,document.getElementById("alergia").value=AdicionarQuebraDeLinha(a.alergia),document.getElementById("medicamentoEmUso").value=AdicionarQuebraDeLinha(a.medicamento_em_uso),document.getElementById("instruEspeciais").value=AdicionarQuebraDeLinha(a.instrucoes_especiais),document.getElementById("outro").value=a.HistoricoMedico.outro,document.getElementById("idUsuario").value=a._id,"VLI"==a.dispositivo.slice(0,3)&&(document.getElementById("mensagemVLI").hidden=!1)},$("[name^=identificadorCliente]").ready(function(){$.getJSON("/cliente/combo",function(e,t){var a=[];$.each(e,function(e,t){a[e]=document.createElement("option"),$(a[e]).attr({value:t}),$(a[e]).append(t),$("select[name=identificadorClienteCreate]").append(a[e])})}),$.getJSON("/cliente/combo",function(e,t){var a=[];$.each(e,function(e,t){a[e]=document.createElement("option"),$(a[e]).attr({value:t}),$(a[e]).append(t),null!==document.getElementById("identificadorClienteEditar")&&($("select[name=identificadorClienteEditar]").append(a[e]),document.getElementById("identificadorClienteEditar").value=clienteParaCombo)})})}),$(document).ready(function(){var e=document.getElementById("tlEditarUser");e.onload=verificaMudancas(),console.log(e)});var verificaMudancas=function(){document.querySelectorAll("input").forEach(function(e){e.addEventListener("input",houveAlteracao)}),document.querySelectorAll("textarea").forEach(function(e){e.addEventListener("input",houveAlteracao)})};$(document).ready(function(){$("#controlDevice").click(function(e){$(this).toggleClass("close_device"),$(".panel_device").toggleClass("show_device")}),$("#fecharModal").click(function(){$(".close").trigger("click")}),$(".box_icone_nav").click(function(e){$(this).toggleClass("menufixo")});var e=!0;$("#control-grid").click(function(t){$(".coluna-control").toggleClass("disable-coluna"),e?(e=!1,$(this).find("i").removeClass("glyphicon-eye-open"),$(this).find("i").addClass("glyphicon-eye-close"),$(this).find("span").text("Ocultar todos os campos")):(e=!0,$(this).find("i").removeClass("glyphicon-eye-close"),$(this).find("i").addClass("glyphicon-eye-open"),$(this).find("span").text("Exibir todos os campos"))}),qtdMensagens=parseInt($("#qtdSosAjuda").text()),0===qtdMensagens&&$(".qtd_notificacao").css("display","none"),qtdMensagens<=1?$("#controlPluralMensagem").text(" Emergência"):$("#controlPluralMensagem").text(" Emergências")});
>>>>>>> f441cccb7120592f7b26185fdcdfb29c6022939a
